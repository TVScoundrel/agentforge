# ST-02001: Implement Raw SQL Query Execution Tool

## Story Overview

Implements a LangGraph tool for executing raw SQL queries against relational databases (PostgreSQL, MySQL, SQLite) with proper parameter binding to prevent SQL injection.

**Epic:** 02 - Query Operations  
**Priority:** P0  
**Dependencies:** ST-01001 âœ…, ST-01002 âœ…, ST-01003 âœ…

## Implementation Summary

### Core Components

1. **Query Types** (`packages/tools/src/data/relational/query/types.ts`)
   - `QueryParams`: Supports positional (array) or named (object) parameters
   - `QueryOptions`: Timeout and maxRows configuration
   - `QueryInput` & `QueryExecutionResult`: Complete interfaces

2. **Query Executor** (`packages/tools/src/data/relational/query/query-executor.ts`)
   - `buildParameterizedQuery()`: Converts SQL placeholders to Drizzle SQL template
     - Positional: `$1`, `$2` (PostgreSQL) and `?` (MySQL/SQLite)
     - Named: `:name`, `:age`
   - `executeQuery()`: Executes queries wit   - `executeQuery()`: Executes  **Relational Query Tool** (`packages/tools/src/data/relational/tools/relational-query.ts`)
   - LangGraph tool using `toolBuilder()` API
   - Category: `ToolCategory.DATABASE`
   - Zod schema validation
   - Automatic connection lifecycle management

#################################L #####tion Preventio#################################L #####tion Preventio###tag########################ion**: Sensitive information removed from error messages
- âœ… **Connection Safety**: Automatic c- âœ… **Connection Safety**: Automatic c- âœ… **Connection Safety**: Automa(SELECT, INSERT, UPDATE, DELETE, error handling)
- **Tool Tests**: 13 tests (metadata, schema validation, invocation)
- **Results**: 32 passed, 19 skipped (SQLite binding checks)
- **Full Suite**: 1108 passed, 32 skipped âœ…

### Quality Gates

- âœ… **Tests**: All passing (32 passed, 19 sk- âœ… **Tests**: All passing (32 passed, 19 sk- âœ… **Tests**: Ae Safety**: Full TypeScript coverage
- âœ… **Documentation**: Complete story documentation

## Usage Example

```typescript
import { relationalQuery } from '@agentforge/tools';

const result = await relationalQuery.invoke({
  sql: 'SELECT * FROM  sql: 'SELECT * FROM  sql: 'SELECT *['active'],
  vendor: 'postgresql',
  connectionString: 'postgresql://user:pass@localhost:5432/mydb'
});

console.log(result.rows);         // Query results
console.log(result.rowCount);     // Number of rows
console.log(result.executionTime); // Execution time in ms
```
```
ole.log(result.executionTime); // Execution time in ms
mydb'
e'],
sing (32 passed, 19 sk- âœ… **Tests**: Ae Safety**: Full TypeScript coverage
0291a8` - test(st-02001): add unit tests for query executor and tool
4. `ab2c9dd` - fix(st-02001): replace any types with unknown for lint complian4. `ab2c9dd` - fix(st-02001): replace any tydoc4. `ab2c9dd` - fcce4. `ab2c9dd` - fix(st-02001): replace any types with unknown for lint complian4. `ab2c9dd` - fix(st-02001): replace any tydoc4. `ab2c9dd` - fcce4 statements
- âœ… Parameter binding prevents SQL injection
- âœ… Result formatting to JSO- âœ… Result formatting to JSO- âœ… Result formatti… Tool schema with clear input/output description- âœ… Result formatting to JSO- âœ… Result formatting to JSO- âœ… Remp- âœ… Result formattintails.

## Next Steps

After merge: ST-02002 (Implement TransactionAfupport)
